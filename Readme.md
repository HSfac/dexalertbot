# **📌 CoinGecko 기반 텔레그램 시세 모니터링 봇 기획서**

## **1. 프로젝트 개요**

- **이름:** CoinGecko 기반 텔레그램 시세 모니터링 봇
- **목적:** 특정 토큰 리스트를 지속적으로 모니터링하고 가격 변동을 텔레그램으로 전송
- **사용 기술:**
  - **Python** (`requests`, `aiogram`, `schedule`, `sqlite3`)
  - **CoinGecko Terminal  API** (토큰 가격 조회) https\://www\.geckoterminal.com/dex-api
  - Telegram Bot API\*\* (가격 변동 알림)
  - **SQLite (********`tokens.db`********\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*)** (사용자별 토큰 리스트 저장)

## **2. 기능 정리**

### **1️⃣ 토큰 가격 모니터링**

- SQLite (`tokens.db`)에서 사용자별 토큰 리스트 로드
- CoinGecko API를 사용해 가격 조회
- 일정 주기마다 가격 변동 확인 (`schedule` 사용)

### **2️⃣ 텔레그램 알림 시스템**

- 가격 변동이 일정 % 이상이면 텔레그램으로 알림 전송
- 사용자별 저장된 토큰에 대해 개별 알림 제공

### **3️⃣ 실시간 가격 조회**

- `/price [토큰이름 또는 주소]` 입력 시 해당 사용자의 리스트에서 토큰 조회 후 가격 반환

### **4️⃣ 토큰 관리**

- `/add [토큰주소]`: 현재 사용자(텔레그램 ID)의 토큰 리스트에 추가
- `/remove [토큰주소]`: 현재 사용자(텔레그램 ID)의 토큰 리스트에서 제거

## **3. 개발 계획**

### **1️⃣ Python 환경 세팅**

- `pip install aiogram requests schedule sqlite3` 실행
- `tokens.db` 파일 생성 및 기본 테이블 설정

### **2️⃣ 기본 기능 구현**

- CoinGecko API 연동 → 사용자별 저장된 토큰 가격 조회
- 일정 주기로 가격 변동 확인 및 SQLite에 기록

### **3️⃣ 텔레그램 봇 연동**

- `/price` 명령 처리 (사용자별 리스트 기반 조회)
- 가격 변동 감지 시 텔레그램 알림 전송

### **4️⃣ 토큰 추가/삭제 기능 구현**

- SQLite에 사용자별 토큰 리스트 저장 및 관리 (`INSERT OR IGNORE` 활용)

### **5️⃣ 배포**

- `screen` 또는 `pm2`를 사용해 서버에서 실행 유지
- AWS EC2, VPS 등에서 실행 가능하도록 설정

## **4. 데이터베이스 구조 (SQLite)**

### **테이블: tokens**

| Column Name | Type    | Description   |
| ----------- | ------- | ------------- |
| user\_id    | INTEGER | 텔레그램 사용자 ID   |
| token       | TEXT    | 토큰 주소 (중복 방지) |

- `user_id + token`을 `UNIQUE`로 설정하여 중복 추가 방지
- `user_id`별로 개별 토큰 리스트를 관리

## **5. 실행 흐름**

1. 사용자가 `/add [토큰주소]` 입력 → DB에 저장
2. 일정 주기마다 CoinGecko API에서 가격 확인
3. 변동 폭이 크면 개별 사용자에게 텔레그램 알림 전송
4. `/price` 입력 시 해당 사용자의 토큰 리스트에서 가격 조회 후 응답
5. `/remove`를 통해 특정 토큰 삭제 가능

✅ **SQLite 기반으로 성능 최적화하면서 확장 가능하도록 설계 완료!**

